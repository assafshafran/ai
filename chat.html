<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>PhAI Chat Demo</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f7f7f7;
        margin: 0;
        padding: 0;
    }

    .chat-container {
        width: 100%;
        max-width: 400px;
        margin: 50px auto;
        background: #ffffff;
        border-radius: 5px;
        border: 1px solid #ccc;
        display: flex;
        flex-direction: column;
        height: 600px;
        overflow: hidden;
    }

    .chat-header {
        background: #4e7ed8;
        padding: 15px;
        color: #fff;
        font-size: 18px;
        text-align: center;
    }

    .chat-messages {
        flex: 1;
        padding: 15px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }

    .message {
        max-width: 80%;
        margin-bottom: 15px;
        line-height: 1.4;
        padding: 10px 14px;
        border-radius: 8px;
        display: inline-block;
        word-wrap: break-word;
        clear: both;
    }

    .message.bot {
        background: #e8f0fe;
        align-self: flex-start;
    }

    .message.user {
        background: #d1ffd5;
        align-self: flex-end;
    }

    /* Hide input for this demo */
    .chat-input {
        display: none;
    }

    .typing-indicator {
        width: 25px;
        height: 10px;
        margin: 0 0 15px 0;
        display: inline-block;
        position: relative;
    }

    .typing-indicator::before, .typing-indicator::after {
        content: '';
        position: absolute;
        top: 0;
        width: 5px;
        height: 5px;
        background: #666;
        border-radius: 50%;
        animation: bounce 1.4s infinite ease-in-out both;
    }

    .typing-indicator::before {
        left: 0;
        animation-delay: -0.32s;
    }

    .typing-indicator::after {
        left: 10px;
        animation-delay: -0.16s;
    }

    @keyframes bounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
    }
</style>
</head>
<body>
<div class="chat-container">
    <div class="chat-header">PhAI</div>
    <div class="chat-messages" id="chat-messages">
    </div>
    <div class="chat-input">
        <input type="text" placeholder="Type your message..." />
        <button>Send</button>
    </div>
</div>

<script>
// Updated conversation: Start with bot asking a question
const conversation = [
    { speaker: 'bot',  text: 'Hi there! I’m here to help gather ideas. How do you think AI could help improve your daily work?' },
    { speaker: 'user', text: 'I think AI could help me quickly analyze data trends so I can spot issues before they become big problems.' },
    { speaker: 'bot',  text: 'That’s a great idea! Can you share what kind of data you deal with and how often you need to review it?' },
    { speaker: 'user', text: 'Mostly production metrics like nutrient levels, temperature readings, and pH values. I typically review them once per batch run, but it’s very manual and I often catch issues too late.' },
    { speaker: 'bot',  text: 'Understood. So an AI tool that continuously monitors these metrics and alerts you to anomalies could help you react sooner. Any other features that would be valuable?' },
    { speaker: 'user', text: 'If it could learn over time what normal production looks like, so it reduces false alarms and only notifies me when something genuinely needs attention, that would be ideal.' },
    { speaker: 'bot',  text: 'Perfect. I’ve recorded:\n- Idea: AI-driven anomaly detection on production metrics\n- Value: Catching issues early and reducing manual checks\n- Additional feature: Adaptive learning to reduce false positives.\n\nAnything else you’d like to add?' },
    { speaker: 'user', text: 'No, that covers it. Thanks for listening!' },
    { speaker: 'bot',  text: 'Great! Your suggestion has been recorded. The team will review it and keep you posted. Feel free to return if you have more ideas!' }
];

const chatMessages = document.getElementById('chat-messages');

function appendMessageInstant(speaker, text) {
    const messageElem = document.createElement('div');
    messageElem.className = `message ${speaker}`;
    messageElem.innerHTML = text.replace(/\n/g, '<br/>');
    chatMessages.appendChild(messageElem);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Typing effect for user messages
function typeUserMessage(text, callback) {
    const messageElem = document.createElement('div');
    messageElem.className = 'message user';
    chatMessages.appendChild(messageElem);
    chatMessages.scrollTop = chatMessages.scrollHeight;

    let i = 0;
    const typingSpeed = 40; // ms per character
    function typeChar() {
        if (i < text.length) {
            messageElem.innerHTML += text[i] === '\n' ? '<br/>' : text[i];
            i++;
            chatMessages.scrollTop = chatMessages.scrollHeight;
            setTimeout(typeChar, typingSpeed);
        } else {
            if (callback) callback();
        }
    }
    typeChar();
}

function playConversation(index = 0) {
    if (index < conversation.length) {
        const { speaker, text } = conversation[index];
        if (speaker === 'user') {
            // User messages typed out
            typeUserMessage(text, () => {
                setTimeout(() => {
                    playConversation(index + 1);
                }, 1500);
            });
        } else {
            // Bot messages appear instantly
            appendMessageInstant(speaker, text);
            setTimeout(() => {
                playConversation(index + 1);
            }, 1500);
        }
    }
}

// Start the simulation
playConversation();
</script>
</body>
</html>
